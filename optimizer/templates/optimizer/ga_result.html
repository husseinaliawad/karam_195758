<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>نتيجة تشغيل GA | BIA601</title>
  <style>
    :root{--bg:#0f172a;--card:#111827;--text:#e5e7eb;--muted:#94a3b8;--accent:#22c55e}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu; background:linear-gradient(135deg,#0f172a,#111827); color:var(--text); min-height:100vh; display:grid; place-items:center}
    .card{width:min(920px,94vw); background:linear-gradient(180deg,rgba(255,255,255,0.04),rgba(255,255,255,0.02)); border:1px solid rgba(255,255,255,0.06); border-radius:16px; padding:28px 24px; box-shadow:0 10px 40px rgba(0,0,0,0.35)}
    h1{font-size:1.4rem; margin:0 0 10px}
    p{margin:0 0 10px; color:var(--muted)}
    .badge{display:inline-block; background:rgba(34,197,94,0.15); color:#86efac; border:1px solid rgba(34,197,94,0.35); padding:4px 10px; border-radius:999px; font-size:.85rem}
    pre{background:rgba(255,255,255,0.05); padding:12px; border-radius:10px; overflow:auto; border:1px solid rgba(255,255,255,0.08)}
    a{color:#86efac}
    table{width:100%; border-collapse:collapse; margin-top:12px}
    th, td{border-bottom:1px solid rgba(255,255,255,0.08); padding:8px; text-align:start}
  </style>
</head>
<body>
  <main class="card">
    <span class="badge">نتيجة تشغيل الخوارزمية الجينية</span>
    <h1>{{ dataset.name|default:dataset.file.name }}</h1>

    {% if error %}
      <p style="color:#fca5a5">خطأ: {{ error }}</p>
      <p><a href="/datasets/">عودة إلى المجموعات</a></p>
    {% else %}
      <p>الهدف: <strong>{{ config.target_column }}</strong> · المهمة: <strong>{{ config.task_type }}</strong> · المقياس: <strong>{{ config.metric }}</strong></p>

      <h3>أفضل نتيجة</h3>
      <table>
        <tr><th>أفضل درجة</th><td>{{ result.best_score }}</td></tr>
        <tr><th>عدد الميزات المختارة</th><td>{{ result.n_features_selected }}</td></tr>
      </table>

      <h3>الميزات المختارة</h3>
      {% if result.best_features %}
        <pre>{{ result.best_features|join:", " }}</pre>
      {% else %}
        <p class="muted">لم تُحدد ميزات.</p>
      {% endif %}

      <h3>ملخص الأجيال</h3>
      {% if result.history %}
        <table>
          <thead>
            <tr>
              <th>الجيل</th>
              <th>أفضل لياقة</th>
              <th>متوسط اللياقة</th>
              <th>عدد الميزات</th>
            </tr>
          </thead>
          <tbody>
            {% for h in result.history %}
            <tr>
              <td>{{ h.generation }}</td>
              <td>{{ h.best_fitness }}</td>
              <td>{{ h.mean_fitness }}</td>
              <td>{{ h.selected_count }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p class="muted">لا يوجد تاريخ.</p>
      {% endif %}

      <p style="margin-top:14px"><a href="/datasets/">عودة إلى المجموعات</a></p>
    {% endif %}
  </main>
</body>
</html>
